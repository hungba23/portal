(self.webpackChunkdevportal=self.webpackChunkdevportal||[]).push([[5512],{4137:function(e,t,o){"use strict";o.d(t,{Zo:function(){return l},kt:function(){return m}});var r=o(7294);function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function a(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,r,n=function(e,t){if(null==e)return{};var o,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)o=a[r],t.indexOf(o)>=0||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)o=a[r],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var p=r.createContext({}),u=function(e){var t=r.useContext(p),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},l=function(e){var t=u(e.components);return r.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var o=e.components,n=e.mdxType,a=e.originalType,p=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=u(o),m=n,h=d["".concat(p,".").concat(m)]||d[m]||c[m]||a;return o?r.createElement(h,i(i({ref:t},l),{},{components:o})):r.createElement(h,i({ref:t},l))}));function m(e,t){var o=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=o.length,i=new Array(a);i[0]=d;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var u=2;u<a;u++)i[u]=o[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,o)}d.displayName="MDXCreateElement"},1547:function(e,t,o){"use strict";o.r(t),o.d(t,{frontMatter:function(){return i},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return u},default:function(){return c}});var r=o(2122),n=o(9756),a=(o(7294),o(4137)),i={id:"apply-logging-prometheus",title:"Monitoring a Node with Prometheus",sidebar_label:"Monitoring a node with Prometheus",description:"Stake pool course: Monitoring a node with Prometheus.",image:"./img/og-developer-portal.png"},s=void 0,p={unversionedId:"stake-pool-course/handbook/apply-logging-prometheus",id:"stake-pool-course/handbook/apply-logging-prometheus",isDocsHomePage:!1,title:"Monitoring a Node with Prometheus",description:"Stake pool course: Monitoring a node with Prometheus.",source:"@site/docs/stake-pool-course/handbook/apply-logging-prometheus.md",sourceDirName:"stake-pool-course/handbook",slug:"/stake-pool-course/handbook/apply-logging-prometheus",permalink:"/docs/stake-pool-course/handbook/apply-logging-prometheus",editUrl:"https://github.com/cardano-foundation/developer-portal/edit/staging/docs/stake-pool-course/handbook/apply-logging-prometheus.md",tags:[],version:"current",lastUpdatedBy:"katomm",lastUpdatedAt:1625336488,formattedLastUpdatedAt:"7/4/2021",frontMatter:{id:"apply-logging-prometheus",title:"Monitoring a Node with Prometheus",sidebar_label:"Monitoring a node with Prometheus",description:"Stake pool course: Monitoring a node with Prometheus.",image:"./img/og-developer-portal.png"},sidebar:"someSidebar",previous:{title:"Register a stake pool with metadata",permalink:"/docs/stake-pool-course/handbook/register-stake-pool-metadata"},next:{title:"Assignment 1",permalink:"/docs/stake-pool-course/assignments/assignment-1"}},u=[{value:"Add Node Exporter to your server",id:"add-node-exporter-to-your-server",children:[]},{value:"Setup Prometheus in your local machine or monitoring server",id:"setup-prometheus-in-your-local-machine-or-monitoring-server",children:[]},{value:"Start prometheus",id:"start-prometheus",children:[]},{value:"Start Prometheus node exporter on your node&#39;s server, for example:",id:"start-prometheus-node-exporter-on-your-nodes-server-for-example",children:[]}],l={toc:u};function c(e){var t=e.components,o=(0,n.Z)(e,["components"]);return(0,a.kt)("wrapper",(0,r.Z)({},l,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Open the port 12798, as it is the default port for prometheus, as from the ",(0,a.kt)("inlineCode",{parentName:"p"},"config.json")," file.\nWhen you start the node, it makes Prometheus metrics available at port 12798 (or whatever port you specified in ",(0,a.kt)("inlineCode",{parentName:"p"},"config.json"),"). You can then setup a monitoring server or monitor your node from your local machine."),(0,a.kt)("h2",{id:"add-node-exporter-to-your-server"},"Add Node Exporter to your server"),(0,a.kt)("p",null,"You can get the best out of prometheus if you have both Prometheus on your local machine or monitoring server and Prometheus Node Exporter on your node's server. How to do this depends on your platform and setup, but you can find documentation:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://prometheus.io/docs/prometheus/latest/getting_started/"},"Prometheus"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://prometheus.io/docs/guides/node-exporter/"},"Node exporter")))),(0,a.kt)("h2",{id:"setup-prometheus-in-your-local-machine-or-monitoring-server"},"Setup Prometheus in your local machine or monitoring server"),(0,a.kt)("p",null,"Prometheus needs to be configured to monitor your Cardano Node. A minimalistic configuration file doing this could look like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"    global:\n      scrape_interval:     15s\n      external_labels:\n        monitor: 'codelab-monitor'\n\n    scrape_configs:\n      - job_name: 'cardano' # To scrape data from the cardano node\n        scrape_interval: 5s\n        static_configs:\n          - targets: ['a.b.c.d:12798']\n      - job_name: 'node' # To scrape data from a node exporter to monitor your linux host metrics.\n        scrape_interval: 5s\n        static_configs:\n          - targets: ['a.b.c.d:9100']\n")),(0,a.kt)("p",null,"You have to replace ",(0,a.kt)("inlineCode",{parentName:"p"},"a.b.c.d")," with the public IP-address of your Cardano Node server, which you can find on the dashboard under ",(0,a.kt)("em",{parentName:"p"},"IPv4 Public IP"),"."),(0,a.kt)("h2",{id:"start-prometheus"},"Start prometheus"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"./prometheus --config.file=prometheus.yml\n")),(0,a.kt)("h2",{id:"start-prometheus-node-exporter-on-your-nodes-server-for-example"},"Start Prometheus node exporter on your node's server, for example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"./node_exporter\n")),(0,a.kt)("p",null,"On your browser open ",(0,a.kt)("inlineCode",{parentName:"p"},"a.b.c.d:9090"),", pick one or more interesting metrics to graph and enjoy!"),(0,a.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"Security configurations you should perform on your monitoring server are out of scope for this tutorial."))))}c.isMDXComponent=!0}}]);